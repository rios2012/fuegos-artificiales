<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Fuegos Artificiales Corazones</title>
<style>
    body {
        margin: 0;
        background: black;
        overflow: hidden;
    }
    canvas {
        display: block;
    }
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Cargar imagen para algunas explosiones
const imagenAria = new Image();
imagenAria.src = "aria.jpeg";

// --- AUDIO DE EXPLOSI칍N ---
let audioHabilitado = false;
const sonidoExplosion = new Audio("artificial.mp3");
sonidoExplosion.volume = 0.5;

function habilitarAudio() {
    audioHabilitado = true;
    document.removeEventListener("click", habilitarAudio);
    document.removeEventListener("touchstart", habilitarAudio);
}
document.addEventListener("click", habilitarAudio);
document.addEventListener("touchstart", habilitarAudio);

// Adaptar canvas al cambiar el tama침o de ventana
window.addEventListener("resize", () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
});

const frases = [
    "Te Amo", "Siempre Juntos", "Amor Eterno", "Eres Mi Todo",
    "Eres mi sol", "Mi dulce amor", "Amor sin fin", "Eres mi vida",
    "Mi eterno amor", "Latidos tuyos", "Amor verdadero", "Para siempre t칰",
    "Amor profundo", "Coraz칩n feliz", "Amor sincero", "Mi media naranja",
    "Eres mi luz", "Siempre t칰"
];

// Fondo de estrellas
let estrellas = [];
for (let i = 0; i < 200; i++) {
    estrellas.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        size: Math.random() * 1.5,
        speed: Math.random() * 0.3
    });
}
function dibujarEstrellas() {
    ctx.fillStyle = "white";
    estrellas.forEach(estrella => {
        ctx.beginPath();
        ctx.arc(estrella.x, estrella.y, estrella.size, 0, Math.PI * 2);
        ctx.fill();
        estrella.y += estrella.speed;
        if (estrella.y > canvas.height) {
            estrella.y = 0;
            estrella.x = Math.random() * canvas.width;
        }
    });
}

// Generador de corazones
function generarCorazon(cx, cy, tama침o) {
    let puntos = [];
    for (let t = 0; t < Math.PI * 2; t += 0.05) {
        let x = tama침o * 16 * Math.pow(Math.sin(t), 3);
        let y = -tama침o * (13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
        puntos.push({x: cx + x, y: cy + y});
    }
    return puntos;
}

let fuegos = [];
let explosiones = [];
const MAX_COHETES = 5;

function colorAleatorio() {
    const colores = [ "#FF0000", "#FF69B4", "#FFC0CB", "#DB7093", "#800080", "#FFD700", "#FFFFFF" ];
    return colores[Math.floor(Math.random() * colores.length)];
}

// Lanzar cohetes
function lanzarCohete() {
    if (fuegos.length >= MAX_COHETES) return;

    let cantidad = Math.floor(Math.random() * 3) + 1;
    for (let i = 0; i < cantidad; i++) {
        if (fuegos.length >= MAX_COHETES) break;
        let x = Math.random() * (canvas.width * 0.8) + canvas.width * 0.1;
        let yObjetivo = Math.random() * (canvas.height * 0.4) + canvas.height * 0.2;
        let frase = frases[Math.floor(Math.random() * frases.length)];
        fuegos.push({
            x: x,
            y: canvas.height,
            yObjetivo: yObjetivo,
            velocidad: -6 - Math.random() * 2,
            trail: [],
            frase: frase,
            chispa: []
        });
    }
}

// Crear explosi칩n (imagen o texto, no ambos)
function crearExplosion(x, y, frase) {
    // 游댉 Reproducir sonido solo si ya est치 habilitado
    if (audioHabilitado) {
        let s = sonidoExplosion.cloneNode();
        setTimeout(() => s.play(), 100); // peque침o retraso para sincronizar con la animaci칩n
    }

    let mostrarImagen = Math.random() < 0.5;
    let contorno = generarCorazon(x, y, 10);
    explosiones.push({
        particulas: contorno.map(p => ({
            x: x, y: y, 
            tx: p.x, ty: p.y,
            alpha: 1,
            trail: [{x: x, y: y}]
        })),
        texto: mostrarImagen ? "" : frase,
        x: x,
        y: y,
        vida: 90,
        mostrarTexto: false,
        textoAlpha: 0,
        mostrarImagen: mostrarImagen
    });
}

// Dibujar cohetes
function dibujarCohetes() {
    for (let i = fuegos.length - 1; i >= 0; i--) {
        let f = fuegos[i];
        f.y += f.velocidad;

        f.trail.push({x: f.x, y: f.y});
        if (f.trail.length > 30) f.trail.shift();
    
        ctx.save();
        for (let j = 1; j < f.trail.length; j++) {
            let alpha = j / f.trail.length;
            ctx.strokeStyle = "#ff0000";
            ctx.globalAlpha = alpha * 0.7;
            ctx.beginPath();
            ctx.moveTo(f.trail[j-1].x, f.trail[j-1].y);
            ctx.lineTo(f.trail[j].x, f.trail[j].y);
            ctx.stroke();
        }
        ctx.restore();
        ctx.globalAlpha = 1;

        if (Math.random() < 0.4) {
            f.chispa.push({
                x: f.x + (Math.random() - 0.5) * 8,
                y: f.y + (Math.random() - 0.5) * 8,
                alpha: 1,
                size: Math.random() * 2 + 1
            });
        }
        for (let c = f.chispa.length - 1; c >= 0; c--) {
            let ch = f.chispa[c];
            ch.alpha -= 0.05;
            ctx.globalAlpha = ch.alpha;
            ctx.fillStyle = "yellow";
            ctx.beginPath();
            ctx.arc(ch.x, ch.y, ch.size, 0, Math.PI * 2);
            ctx.fill();
            if (ch.alpha <= 0) f.chispa.splice(c, 1);
        }
        ctx.globalAlpha = 1;

        ctx.fillStyle = "#ff0000";
        ctx.beginPath();
        ctx.arc(f.x, f.y, 4, 0, Math.PI * 2);
        ctx.fill();

        if (f.y <= f.yObjetivo) {
            crearExplosion(f.x, f.y, f.frase);
            fuegos.splice(i, 1);
        }
    }
}

// Dibujar explosiones
function dibujarExplosiones() {
    for (let i = explosiones.length - 1; i >= 0; i--) {
        const explosion = explosiones[i];
        explosion.vida--;
        const fade = explosion.vida / 90;

        if (explosion.vida < 70) {
            explosion.mostrarTexto = true;
            if (explosion.textoAlpha < 1) {
                explosion.textoAlpha += 0.05;
            }
        }

        explosion.particulas.forEach(p => {
            p.x += (p.tx - p.x) * 0.05;
            p.y += (p.ty - p.y) * 0.05;
            p.trail.push({x: p.x, y: p.y});
            if (p.trail.length > 15) p.trail.shift();

            if (!p.chispa) p.chispa = [];
            if (Math.random() < 0.3) {
                p.chispa.push({
                    x: p.x + (Math.random() - 0.5) * 6,
                    y: p.y + (Math.random() - 0.5) * 6,
                    alpha: 1,
                    size: Math.random() * 2 + 1,
                    color: colorAleatorio()
                });
            }

            for (let c = p.chispa.length - 1; c >= 0; c--) {
                let ch = p.chispa[c];
                ch.alpha -= 0.04;
                if (ch.alpha <= 0) {
                    p.chispa.splice(c, 1);
                    continue;
                }
                ctx.globalAlpha = ch.alpha * (explosion.vida / 60);
                ctx.fillStyle = ch.color;
                ctx.beginPath();
                ctx.arc(ch.x, ch.y, ch.size, 0, Math.PI * 2);
                ctx.fill();
            }

            ctx.save();
            ctx.globalAlpha = 0.6 * fade;
            ctx.strokeStyle = "#ff0000";
            ctx.lineWidth = 1;
            for (let j = 1; j < p.trail.length; j++) {
                ctx.moveTo(p.trail[j-1].x, p.trail[j-1].y);
                ctx.lineTo(p.trail[j].x, p.trail[j].y);
            }
            ctx.stroke();
            ctx.restore();

            ctx.fillStyle = "#ff0000";
            ctx.globalAlpha = fade;
            ctx.beginPath();
            ctx.arc(p.x, p.y, 3, 0, Math.PI * 2);
            ctx.fill();
        });

        if (explosion.mostrarTexto && !explosion.mostrarImagen) {
            ctx.globalAlpha = explosion.textoAlpha * fade;
            ctx.font = "bold 26px Arial";
            ctx.fillStyle = "pink";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText(explosion.texto, explosion.x, explosion.y - 5);
        }

        if (explosion.mostrarImagen) {
            let tama침oImg = 120;
            ctx.globalAlpha = explosion.textoAlpha * fade;
            ctx.drawImage(imagenAria, explosion.x - tama침oImg/2, explosion.y - tama침oImg/2, tama침oImg, tama침oImg);
        }

        ctx.globalAlpha = 1;
        if (explosion.vida <= 0) explosiones.splice(i, 1);
    }
}

function animar() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    dibujarEstrellas();
    dibujarCohetes();
    dibujarExplosiones();
    requestAnimationFrame(animar);
}

setInterval(lanzarCohete, 1600);
animar();
</script>
</body>
</html>

